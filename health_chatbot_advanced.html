<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthCare AI Assistant - Advanced Health Companion</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow: hidden;
        }

        #root {
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .app-container {
            width: 100%;
            max-width: 1400px;
            height: 95vh;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4ade80;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .header-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 0.95em;
        }

        .header-btn:hover {
            background: white;
            color: #667eea;
            transform: translateY(-2px);
        }

        .main-layout {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 320px;
            background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
            border-right: 1px solid #dee2e6;
            overflow-y: auto;
            padding: 20px;
        }

        .sidebar-section {
            margin-bottom: 25px;
        }

        .sidebar-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .health-stats {
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 12px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: #6c757d;
            font-size: 0.9em;
        }

        .stat-value {
            color: #212529;
            font-weight: 600;
            font-size: 1.1em;
        }

        .reminder-card {
            background: white;
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 12px;
            border-left: 4px solid #667eea;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: transform 0.2s;
        }

        .reminder-card:hover {
            transform: translateX(5px);
        }

        .reminder-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .reminder-name {
            color: #212529;
            font-weight: 600;
            font-size: 1em;
        }

        .reminder-time {
            color: #667eea;
            font-weight: 700;
            font-size: 0.95em;
        }

        .reminder-details {
            color: #6c757d;
            font-size: 0.85em;
            margin-top: 5px;
        }

        .delete-btn {
            margin-top: 10px;
            padding: 6px 14px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8em;
            font-weight: 600;
            transition: all 0.2s;
        }

        .delete-btn:hover {
            background: #c82333;
            transform: scale(1.05);
        }

        .add-reminder-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1em;
            transition: all 0.3s;
        }

        .add-reminder-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .health-tip-card {
            background: linear-gradient(135deg, #e0f7fa 0%, #f3e5f5 100%);
            padding: 16px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .health-tip-card h4 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .health-tip-card p {
            color: #424242;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #ffffff;
        }

        .context-banner {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 12px 20px;
            border-bottom: 2px solid #fbbf24;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9em;
            color: #92400e;
        }

        .context-banner strong {
            color: #78350f;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
            background: linear-gradient(180deg, #fafafa 0%, #ffffff 100%);
        }

        .message {
            margin-bottom: 20px;
            display: flex;
            gap: 12px;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            flex-shrink: 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        .message.bot .message-avatar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .message.user .message-avatar {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .message-content {
            max-width: 75%;
            padding: 16px 20px;
            border-radius: 16px;
            line-height: 1.6;
            font-size: 0.95em;
        }

        .message.bot .message-content {
            background: #f1f3f5;
            border-bottom-left-radius: 4px;
            color: #212529;
        }

        .message.user .message-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-bottom-right-radius: 4px;
            color: white;
        }

        .message-content strong {
            display: block;
            margin-bottom: 8px;
            font-size: 1.05em;
        }

        .message-content ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .message-content li {
            margin: 5px 0;
        }

        .symptom-badge {
            display: inline-block;
            background: #fee2e2;
            color: #991b1b;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.85em;
            margin: 4px;
            font-weight: 600;
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px 20px;
            background: #f1f3f5;
            border-radius: 16px;
            width: fit-content;
            border-bottom-left-radius: 4px;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dots span {
            height: 10px;
            width: 10px;
            background: #667eea;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% { 
                transform: translateY(0);
                opacity: 0.7;
            }
            30% { 
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        .quick-actions {
            padding: 15px 20px;
            background: white;
            border-top: 1px solid #e9ecef;
            display: flex;
            gap: 10px;
            overflow-x: auto;
            flex-wrap: wrap;
        }

        .quick-btn {
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            padding: 10px 18px;
            border-radius: 20px;
            cursor: pointer;
            white-space: nowrap;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s;
        }

        .quick-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .chat-input-area {
            padding: 20px;
            background: white;
            border-top: 2px solid #e9ecef;
        }

        .input-wrapper {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }

        .chat-input {
            flex: 1;
            padding: 16px 20px;
            border: 2px solid #dee2e6;
            border-radius: 25px;
            font-size: 1em;
            outline: none;
            transition: all 0.3s;
            resize: none;
            min-height: 50px;
            max-height: 120px;
            font-family: inherit;
        }

        .chat-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }

        .send-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 700;
            font-size: 1em;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .send-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal {
            background: white;
            border-radius: 20px;
            padding: 35px;
            max-width: 550px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal h2 {
            color: #667eea;
            margin-bottom: 25px;
            font-size: 1.8em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #495057;
            font-weight: 600;
            font-size: 0.95em;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            font-size: 1em;
            outline: none;
            transition: all 0.3s;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 700;
            width: 100%;
            font-size: 1.05em;
            margin-top: 10px;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 700;
            width: 100%;
            font-size: 1.05em;
            margin-top: 10px;
            transition: all 0.3s;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .alert {
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 0.9em;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border-left: 4px solid #ffc107;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 4px solid #17a2b8;
        }

        @media (max-width: 768px) {
            .app-container {
                height: 100vh;
                border-radius: 0;
            }

            .sidebar {
                display: none;
            }

            .message-content {
                max-width: 85%;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Main App Component
        function HealthCareApp() {
            const [messages, setMessages] = useState([]);
            const [inputValue, setInputValue] = useState('');
            const [isTyping, setIsTyping] = useState(false);
            const [reminders, setReminders] = useState([]);
            const [userProfile, setUserProfile] = useState({});
            const [showReminderModal, setShowReminderModal] = useState(false);
            const [showProfileModal, setShowProfileModal] = useState(false);
            const [conversationContext, setConversationContext] = useState({
                symptoms: [],
                concerns: [],
                medications: [],
                lastTopic: null
            });
            const messagesEndRef = useRef(null);
            const chatInputRef = useRef(null);

            // Storage helper
            const storage = {
                get: async (key) => {
                    try {
                        const result = await window.storage.get(key, false);
                        return result ? JSON.parse(result.value) : null;
                    } catch (e) {
                        return null;
                    }
                },
                set: async (key, value) => {
                    try {
                        await window.storage.set(key, JSON.stringify(value), false);
                    } catch (e) {
                        console.error('Storage error:', e);
                    }
                }
            };

            // Load data on mount
            useEffect(() => {
                loadData();
                addBotMessage(
                    "Hello! I'm your AI Health Assistant. üëã\n\n" +
                    "I'm here to help you with:\n" +
                    "‚Ä¢ Medical questions and health concerns\n" +
                    "‚Ä¢ Personalized diet and nutrition plans\n" +
                    "‚Ä¢ Exercise recommendations\n" +
                    "‚Ä¢ Medicine reminders and management\n" +
                    "‚Ä¢ Health tips and preventive care\n\n" +
                    "**Important:** I provide general health information. For serious symptoms or emergencies, please consult a healthcare professional immediately.\n\n" +
                    "How are you feeling today? Tell me about any health concerns you have."
                );
            }, []);

            // Auto-scroll to bottom
            useEffect(() => {
                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            }, [messages, isTyping]);

            // Check reminders
            useEffect(() => {
                const interval = setInterval(checkReminders, 60000);
                checkReminders();
                return () => clearInterval(interval);
            }, [reminders]);

            async function loadData() {
                const loadedReminders = await storage.get('health-reminders');
                const loadedProfile = await storage.get('health-profile');
                
                if (loadedReminders) setReminders(loadedReminders);
                if (loadedProfile) setUserProfile(loadedProfile);
            }

            function addBotMessage(text) {
                setMessages(prev => [...prev, { type: 'bot', text, timestamp: new Date() }]);
            }

            function addUserMessage(text) {
                setMessages(prev => [...prev, { type: 'user', text, timestamp: new Date() }]);
            }

            async function sendMessage() {
                if (!inputValue.trim() || isTyping) return;

                const userMessage = inputValue.trim();
                addUserMessage(userMessage);
                setInputValue('');
                setIsTyping(true);

                // Analyze message for context
                analyzeUserMessage(userMessage);

                // Get AI response
                await getAIResponse(userMessage);
                setIsTyping(false);
            }

            function analyzeUserMessage(message) {
                const lowerMessage = message.toLowerCase();
                
                // Extract symptoms
                const symptomKeywords = ['fever', 'feverish', 'headache', 'cough', 'cold', 'pain', 'dizzy', 'nausea', 'tired', 'fatigue', 'sore', 'ache', 'sick'];
                const detectedSymptoms = symptomKeywords.filter(s => lowerMessage.includes(s));
                
                if (detectedSymptoms.length > 0) {
                    setConversationContext(prev => ({
                        ...prev,
                        symptoms: [...new Set([...prev.symptoms, ...detectedSymptoms])]
                    }));
                }

                // Detect topic
                if (lowerMessage.includes('diet') || lowerMessage.includes('food') || lowerMessage.includes('eat')) {
                    setConversationContext(prev => ({ ...prev, lastTopic: 'nutrition' }));
                } else if (lowerMessage.includes('exercise') || lowerMessage.includes('workout')) {
                    setConversationContext(prev => ({ ...prev, lastTopic: 'exercise' }));
                } else if (detectedSymptoms.length > 0) {
                    setConversationContext(prev => ({ ...prev, lastTopic: 'symptoms' }));
                }
            }

            async function getAIResponse(userMessage) {
                try {
                    // Build comprehensive system prompt
                    let systemPrompt = `You are an empathetic, intelligent AI health assistant. You provide helpful health advice while being warm, understanding, and supportive.

CONVERSATION CONTINUITY: This is an ongoing conversation. Reference previous messages and build on the context naturally. If the user mentioned symptoms earlier, acknowledge them and ask follow-up questions.

YOUR CAPABILITIES:
- Answer health questions with accurate, evidence-based information
- Provide detailed, personalized diet plans with specific meal suggestions and recipes
- Recommend appropriate exercises based on age and condition
- Suggest home remedies and natural treatments
- Offer preventive health tips and lifestyle advice
- Help manage chronic conditions with practical advice
- Be especially patient and clear with elderly users

RESPONSE STYLE:
- Be conversational and warm, not clinical
- Ask relevant follow-up questions to better understand their situation
- Show empathy and understanding
- Use clear, simple language
- Format responses with sections, bullet points, and emphasis for readability
- Provide actionable, specific advice with examples
- Include home remedies, diet suggestions, and lifestyle changes
- Give detailed meal plans when asked about diet

IMPORTANT - ALWAYS PROVIDE HELPFUL CONTENT:
- For fever: Suggest rest, hydration, temperature monitoring, foods to eat, what to avoid
- For diet plans: Give specific breakfast/lunch/dinner examples with portion sizes
- For conditions: Provide comprehensive management strategies
- For symptoms: Explain possible causes, home care, when to see a doctor

SAFETY GUIDELINES:
- ALWAYS ask about severity of symptoms to assess urgency
- For serious symptoms (high fever >103¬∞F, severe pain, breathing difficulty, chest pain), IMMEDIATELY recommend seeking emergency care
- Never diagnose specific diseases - instead describe what symptoms might indicate
- Suggest over-the-counter remedies but never prescribe prescription medications
- Always emphasize the importance of consulting healthcare professionals for diagnosis
- Be extra cautious with symptoms in elderly, children, and pregnant women

CONTEXT AWARENESS:`;

                    // Add user profile
                    if (userProfile.age) {
                        systemPrompt += `\n\nUSER PROFILE:
- Age: ${userProfile.age}
- Gender: ${userProfile.gender || 'Not specified'}
- Existing conditions: ${userProfile.conditions || 'None mentioned'}
- Allergies: ${userProfile.allergies || 'None mentioned'}`;
                    }

                    // Add conversation context
                    if (conversationContext.symptoms.length > 0) {
                        systemPrompt += `\n\nRECENT SYMPTOMS MENTIONED: ${conversationContext.symptoms.join(', ')}`;
                        systemPrompt += `\nBe sure to follow up on these symptoms and provide relevant advice.`;
                    }

                    if (conversationContext.lastTopic) {
                        systemPrompt += `\n\nCURRENT TOPIC: ${conversationContext.lastTopic}`;
                    }

                    // Build conversation history
                    const conversationHistory = messages.slice(-8).map(msg => ({
                        role: msg.type === 'user' ? 'user' : 'assistant',
                        content: msg.text
                    }));

                    conversationHistory.push({
                        role: 'user',
                        content: userMessage
                    });

                    const response = await fetch("https://api.anthropic.com/v1/messages", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            model: "claude-sonnet-4-20250514",
                            max_tokens: 2000,
                            system: systemPrompt,
                            messages: conversationHistory
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`API Error: ${response.status}`);
                    }

                    const data = await response.json();
                    
                    if (data.content && data.content[0]) {
                        const aiResponse = data.content[0].text;
                        addBotMessage(aiResponse);
                    } else {
                        throw new Error('Invalid AI response');
                    }
                } catch (error) {
                    console.error('AI Error:', error);
                    // Provide helpful fallback response based on the question
                    provideFallbackResponse(userMessage);
                }
            }

            function provideFallbackResponse(userMessage) {
                const lowerMsg = userMessage.toLowerCase();
                
                // Fever response
                if (lowerMsg.includes('fever') || lowerMsg.includes('feverish')) {
                    addBotMessage(`I understand you're feeling feverish. Let me help you with some guidance:

**Immediate Care for Fever:**

**What to Do:**
‚Ä¢ Rest as much as possible - your body needs energy to fight infection
‚Ä¢ Stay hydrated - drink water, clear broths, herbal teas (8-10 glasses/day)
‚Ä¢ Monitor temperature every 4 hours
‚Ä¢ Take acetaminophen (Tylenol) or ibuprofen (Advil) as directed on package

**Home Remedies:**
‚Ä¢ Cool compress on forehead and neck
‚Ä¢ Lukewarm bath (not cold) to reduce temperature
‚Ä¢ Wear light, breathable clothing
‚Ä¢ Keep room temperature comfortable (not too warm)

**Foods to Eat:**
‚Ä¢ Chicken soup or vegetable broth
‚Ä¢ Bananas (easy to digest, rich in potassium)
‚Ä¢ Rice porridge (khichdi)
‚Ä¢ Toast or crackers
‚Ä¢ Yogurt (probiotics boost immunity)
‚Ä¢ Citrus fruits (vitamin C)
‚Ä¢ Coconut water (hydration + electrolytes)

**Foods to Avoid:**
‚Ä¢ Spicy or fried foods
‚Ä¢ Heavy meals
‚Ä¢ Caffeine and alcohol
‚Ä¢ Sugary drinks

**Herbal Remedies:**
‚Ä¢ Tulsi (holy basil) tea
‚Ä¢ Ginger tea with honey
‚Ä¢ Turmeric milk (haldi doodh)

**When to See a Doctor:**
üö® Fever above 103¬∞F (39.4¬∞C)
üö® Fever lasting more than 3 days
üö® Severe headache or stiff neck
üö® Difficulty breathing
üö® Persistent vomiting
üö® Confusion or unusual behavior

**For elderly patients (65+):** Be extra cautious and consult a doctor if fever persists beyond 24 hours.

Would you like specific meal plans or more information about managing your symptoms?`);
                }
                // Diabetes diet
                else if (lowerMsg.includes('diabetes') && (lowerMsg.includes('diet') || lowerMsg.includes('food') || lowerMsg.includes('eat'))) {
                    addBotMessage(`Here's a comprehensive **Diabetes-Friendly Diet Plan**:

**Daily Meal Plan:**

üåÖ **BREAKFAST (8:00 AM)**
Option 1: Indian
‚Ä¢ 2 multigrain rotis
‚Ä¢ 1 bowl vegetable daliya (oats porridge)
‚Ä¢ 1 boiled egg or paneer bhurji
‚Ä¢ 1/2 cup buttermilk

Option 2: Western
‚Ä¢ 2 scrambled eggs
‚Ä¢ 1 slice whole wheat toast
‚Ä¢ 1/2 cup berries
‚Ä¢ Unsweetened almond milk

**Mid-Morning Snack (11:00 AM)**
‚Ä¢ 1 small apple with 10 almonds
‚Ä¢ OR green tea + 2-3 whole wheat crackers

üåû **LUNCH (1:00 PM)**
‚Ä¢ 2 bajra/jowar rotis
‚Ä¢ 1 bowl dal (moong/masoor)
‚Ä¢ 1 bowl mixed vegetables (palak, bhindi, beans)
‚Ä¢ Cucumber-tomato salad
‚Ä¢ 1 bowl curd

**Evening Snack (4:00 PM)**
‚Ä¢ Roasted chana (chickpeas)
‚Ä¢ OR vegetable soup
‚Ä¢ Green/herbal tea

üåô **DINNER (7:30 PM)**
‚Ä¢ 1.5 rotis or 1/2 cup brown rice
‚Ä¢ Grilled fish/chicken or rajma/chole
‚Ä¢ 1 bowl green vegetable
‚Ä¢ Clear soup or raita

**KEY PRINCIPLES:**

‚úÖ **Foods to Include:**
‚Ä¢ Whole grains (brown rice, oats, quinoa)
‚Ä¢ Lean proteins (fish, chicken, eggs, dal, paneer)
‚Ä¢ Non-starchy vegetables (spinach, broccoli, peppers)
‚Ä¢ Healthy fats (nuts, seeds, olive oil)
‚Ä¢ Low-glycemic fruits (berries, apple, guava)

‚ùå **Foods to Avoid:**
‚Ä¢ White rice, white bread, maida
‚Ä¢ Sugary drinks and desserts
‚Ä¢ Fried foods
‚Ä¢ Processed snacks
‚Ä¢ Fruit juices (even fresh)

**Important Tips:**
1. Eat at the same time every day
2. Portion control is crucial
3. Never skip meals
4. Check blood sugar 2 hours after meals
5. Stay hydrated (8-10 glasses water)
6. Include fiber in every meal (minimum 25g/day)

**Diabetes Superfoods:**
‚Ä¢ Bitter gourd (karela)
‚Ä¢ Fenugreek seeds (methi)
‚Ä¢ Cinnamon
‚Ä¢ Amla (Indian gooseberry)
‚Ä¢ Jamun (black plum)

Would you like specific recipes or a weekly meal plan?`);
                }
                // Senior exercise
                else if ((lowerMsg.includes('exercise') || lowerMsg.includes('workout')) && (lowerMsg.includes('senior') || lowerMsg.includes('elderly') || lowerMsg.includes('old'))) {
                    addBotMessage(`Here's a safe and effective **Exercise Plan for Seniors**:

**üèÉ Daily Exercise Routine (30-45 minutes)**

**WARM-UP (5 minutes):**
‚Ä¢ Gentle neck rotations
‚Ä¢ Shoulder rolls
‚Ä¢ Ankle circles
‚Ä¢ March in place slowly

**CARDIOVASCULAR (15-20 minutes):**
Choose one:
‚Ä¢ Brisk walking (most recommended)
‚Ä¢ Swimming or water aerobics
‚Ä¢ Stationary cycling
‚Ä¢ Dancing to music

**STRENGTH TRAINING (10-15 minutes, 3x per week):**
‚Ä¢ Chair squats (10 reps)
‚Ä¢ Wall push-ups (8-10 reps)
‚Ä¢ Bicep curls with light weights (10 reps)
‚Ä¢ Leg raises while holding chair (10 each leg)

**BALANCE EXERCISES (5-10 minutes):**
‚Ä¢ Stand on one foot (hold chair for support)
‚Ä¢ Heel-to-toe walk
‚Ä¢ Tai Chi movements
‚Ä¢ Standing hip circles

**FLEXIBILITY (5-10 minutes):**
‚Ä¢ Seated toe touches
‚Ä¢ Neck and shoulder stretches
‚Ä¢ Hamstring stretches
‚Ä¢ Gentle yoga poses

**SAFETY TIPS:**
‚ö†Ô∏è Always consult doctor before starting
‚ö†Ô∏è Start slowly and increase gradually
‚ö†Ô∏è Stay hydrated
‚ö†Ô∏è Wear proper footwear
‚ö†Ô∏è Exercise with a buddy when possible
‚ö†Ô∏è Stop if you feel dizzy, pain, or short of breath

**BEST TIME TO EXERCISE:**
‚Ä¢ Morning (7-9 AM) or Evening (5-7 PM)
‚Ä¢ Avoid exercising right after meals
‚Ä¢ Never exercise during extreme heat

**Weekly Schedule:**
‚Ä¢ Monday: Walking + Stretching
‚Ä¢ Tuesday: Strength Training
‚Ä¢ Wednesday: Walking + Balance
‚Ä¢ Thursday: Rest or light yoga
‚Ä¢ Friday: Strength Training
‚Ä¢ Saturday: Walking + Swimming
‚Ä¢ Sunday: Gentle stretching or rest

**Benefits for Seniors:**
‚úÖ Improves heart health
‚úÖ Strengthens bones (prevents osteoporosis)
‚úÖ Enhances balance (reduces fall risk)
‚úÖ Boosts mood and mental health
‚úÖ Better sleep quality
‚úÖ Manages chronic conditions (diabetes, BP)

Would you like specific exercises for any health condition?`);
                }
                // Sleep improvement
                else if (lowerMsg.includes('sleep') || lowerMsg.includes('insomnia')) {
                    addBotMessage(`Here's a complete guide to **Improve Your Sleep Quality**:

**üåô Bedtime Routine (Start 1 hour before sleep):**

**9:00 PM - Wind Down:**
‚Ä¢ Dim the lights
‚Ä¢ Turn off TV and phones
‚Ä¢ Light reading or gentle music
‚Ä¢ Avoid work emails

**9:30 PM - Relaxation:**
‚Ä¢ Warm bath or shower
‚Ä¢ Gentle stretching or yoga
‚Ä¢ Deep breathing exercises
‚Ä¢ Meditation (10 minutes)

**10:00 PM - Sleep Time:**
‚Ä¢ Dark, cool room (65-68¬∞F)
‚Ä¢ Comfortable mattress and pillow
‚Ä¢ White noise if needed

**Sleep-Promoting Foods:**

**Evening Snack (8:00 PM):**
‚Ä¢ Warm milk with turmeric
‚Ä¢ Banana with almond butter
‚Ä¢ Chamomile or lavender tea
‚Ä¢ Small bowl of oatmeal
‚Ä¢ Handful of walnuts

**Foods to Avoid (after 6 PM):**
‚ùå Caffeine (coffee, tea, chocolate)
‚ùå Alcohol
‚ùå Heavy or spicy meals
‚ùå Sugary snacks
‚ùå Large amounts of water (to avoid bathroom trips)

**Lifestyle Changes:**

**During the Day:**
‚Ä¢ Wake up at same time daily (even weekends)
‚Ä¢ Get sunlight exposure in morning
‚Ä¢ Exercise (but not close to bedtime)
‚Ä¢ Limit daytime naps to 20 minutes

**Sleep Environment:**
‚Ä¢ Blackout curtains or eye mask
‚Ä¢ Earplugs or white noise machine
‚Ä¢ Cool temperature (18-20¬∞C)
‚Ä¢ Comfortable bedding
‚Ä¢ Remove electronics

**Natural Sleep Remedies:**

‚Ä¢ **Melatonin-rich foods:** Cherries, tomatoes, walnuts
‚Ä¢ **Magnesium:** Spinach, almonds, dark chocolate
‚Ä¢ **Herbal teas:** Chamomile, valerian root, passionflower
‚Ä¢ **Essential oils:** Lavender (on pillow or diffuser)
‚Ä¢ **Ashwagandha:** Ancient Ayurvedic herb

**Breathing Exercise for Sleep (4-7-8 Technique):**
1. Inhale through nose for 4 counts
2. Hold breath for 7 counts
3. Exhale through mouth for 8 counts
4. Repeat 4 times

**When to See a Doctor:**
üö® Insomnia lasting more than 3 weeks
üö® Loud snoring or breathing pauses (sleep apnea)
üö® Extreme daytime fatigue
üö® Restless legs or unusual movements

**Sleep Hygiene Checklist:**
‚úÖ Same sleep/wake time
‚úÖ Exercise daily
‚úÖ Limit caffeine after 2 PM
‚úÖ Dark, quiet, cool room
‚úÖ No screens 1 hour before bed
‚úÖ Relaxation routine
‚úÖ Comfortable bedding

Try these for 2 weeks and track your improvement. Would you like specific meditation techniques or sleep tracking tips?`);
                }
                // Stress management
                else if (lowerMsg.includes('stress') || lowerMsg.includes('anxiety') || lowerMsg.includes('tension')) {
                    addBotMessage(`Here's a comprehensive **Stress Management Guide**:

**üßò Immediate Stress Relief (Use anytime):**

**Deep Breathing (2 minutes):**
‚Ä¢ Sit comfortably
‚Ä¢ Breathe in slowly for 4 counts
‚Ä¢ Hold for 4 counts
‚Ä¢ Breathe out for 6 counts
‚Ä¢ Repeat 10 times

**Quick Relaxation Techniques:**
‚Ä¢ Progressive muscle relaxation
‚Ä¢ 5-minute walk
‚Ä¢ Listen to calming music
‚Ä¢ Splash cold water on face
‚Ä¢ Call a friend

**Daily Stress Management Routine:**

**Morning (7:00 AM):**
‚Ä¢ 10 minutes meditation
‚Ä¢ Gratitude journaling (write 3 things)
‚Ä¢ Healthy breakfast
‚Ä¢ Light exercise or yoga

**Throughout Day:**
‚Ä¢ Take regular breaks (every 90 minutes)
‚Ä¢ Stay hydrated
‚Ä¢ Healthy snacks
‚Ä¢ Brief walks

**Evening (7:00 PM):**
‚Ä¢ Gentle exercise (walk, swim, yoga)
‚Ä¢ Hobby or creative activity
‚Ä¢ Quality time with family
‚Ä¢ Avoid work emails

**Night (9:00 PM):**
‚Ä¢ Relaxing bath
‚Ä¢ Reading
‚Ä¢ Gentle stretching
‚Ä¢ Prepare for tomorrow

**Stress-Busting Foods:**

‚úÖ **Include:**
‚Ä¢ Dark chocolate (in moderation)
‚Ä¢ Green tea (L-theanine reduces stress)
‚Ä¢ Berries (antioxidants)
‚Ä¢ Nuts (magnesium)
‚Ä¢ Yogurt (probiotics for gut-brain health)
‚Ä¢ Salmon (omega-3)
‚Ä¢ Oranges (vitamin C)

‚ùå **Avoid:**
‚Ä¢ Excess caffeine
‚Ä¢ Alcohol
‚Ä¢ Sugary foods
‚Ä¢ Processed foods
‚Ä¢ High-sodium foods

**Exercise for Stress Relief:**

**Best Activities:**
‚Ä¢ Yoga (especially restorative)
‚Ä¢ Walking in nature
‚Ä¢ Swimming
‚Ä¢ Dancing
‚Ä¢ Tai Chi
‚Ä¢ Cycling

**Recommended:** 30 minutes, 5 days/week

**Mental Wellness Practices:**

**Meditation (10-20 minutes daily):**
‚Ä¢ Guided meditation apps
‚Ä¢ Mindfulness practice
‚Ä¢ Body scan meditation
‚Ä¢ Loving-kindness meditation

**Journaling:**
‚Ä¢ Write worries before bed
‚Ä¢ Express emotions freely
‚Ä¢ Problem-solve on paper
‚Ä¢ Track mood patterns

**Social Connection:**
‚Ä¢ Regular calls with loved ones
‚Ä¢ Join support groups
‚Ä¢ Volunteer work
‚Ä¢ Hobby clubs

**Herbal Remedies for Stress:**

‚Ä¢ **Ashwagandha:** Adaptogen, reduces cortisol
‚Ä¢ **Brahmi:** Enhances mental clarity
‚Ä¢ **Chamomile tea:** Calming effect
‚Ä¢ **Tulsi (Holy Basil):** Stress reliever
‚Ä¢ **Lavender:** Aromatherapy

**When to Seek Professional Help:**
üö® Stress affecting daily functioning
üö® Persistent anxiety or panic attacks
üö® Sleep problems for weeks
üö® Physical symptoms (chest pain, headaches)
üö® Thoughts of self-harm

**Quick Stress-Relief Checklist:**
‚úÖ Deep breathing daily
‚úÖ Regular exercise
‚úÖ Healthy sleep routine
‚úÖ Social connections
‚úÖ Hobby or creative outlet
‚úÖ Limit news/social media
‚úÖ Time in nature
‚úÖ Professional help if needed

Would you like specific meditation techniques or yoga poses for stress relief?`);
                }
                // General health query
                else {
                    addBotMessage(`Thank you for your question! I'm here to help with your health concerns.

To provide you with the most accurate and helpful advice, could you please tell me more about:

**What I can help you with:**

üè• **Symptoms & Conditions:**
‚Ä¢ Fever, cold, cough management
‚Ä¢ Headaches and body pain
‚Ä¢ Digestive issues
‚Ä¢ Sleep problems
‚Ä¢ General health concerns

üçΩÔ∏è **Diet & Nutrition:**
‚Ä¢ Diabetes-friendly meal plans
‚Ä¢ Weight loss/gain diets
‚Ä¢ Heart-healthy eating
‚Ä¢ Diet for specific conditions
‚Ä¢ Meal planning and recipes

üíä **Health Management:**
‚Ä¢ Medicine reminders
‚Ä¢ Chronic condition management
‚Ä¢ Preventive health tips
‚Ä¢ Lifestyle modifications

üí™ **Exercise & Fitness:**
‚Ä¢ Senior-friendly exercises
‚Ä¢ Yoga and stretching
‚Ä¢ Walking programs
‚Ä¢ Strength training

üåø **Home Remedies:**
‚Ä¢ Natural treatments
‚Ä¢ Herbal remedies
‚Ä¢ Traditional medicine (Ayurveda)

**Please share:**
1. What specific health concern do you have?
2. Any symptoms you're experiencing?
3. Your age (helps me personalize advice)
4. Any existing health conditions?

I'm here to provide detailed, practical advice including remedies, diet plans, and lifestyle recommendations!`);
                }
            }

            function handleKeyPress(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            }

            function quickAsk(question) {
                setInputValue(question);
                chatInputRef.current?.focus();
            }

            function checkReminders() {
                const now = new Date();
                const currentTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;

                reminders.forEach(reminder => {
                    if (reminder.time === currentTime && reminder.active) {
                        showReminderNotification(reminder);
                        addBotMessage(`‚è∞ **Medicine Reminder**\n\nTime to take your medicine:\n‚Ä¢ **${reminder.name}** - ${reminder.dosage}\n${reminder.notes ? `\nNote: ${reminder.notes}` : ''}\n\nHave you taken it?`);
                    }
                });
            }

            function showReminderNotification(reminder) {
                if ("Notification" in window && Notification.permission === "granted") {
                    new Notification("üíä Medicine Reminder", {
                        body: `Time to take ${reminder.name} - ${reminder.dosage}`,
                        icon: "üíä",
                        requireInteraction: true
                    });
                }
            }

            async function addReminder(reminderData) {
                const newReminder = {
                    id: Date.now(),
                    ...reminderData,
                    active: true
                };
                const updatedReminders = [...reminders, newReminder];
                setReminders(updatedReminders);
                await storage.set('health-reminders', updatedReminders);
                setShowReminderModal(false);
                addBotMessage(`‚úÖ Perfect! I've set a reminder for **${reminderData.name}** at **${reminderData.time}**. I'll remind you when it's time to take your medicine.`);
            }

            async function deleteReminder(id) {
                const updatedReminders = reminders.filter(r => r.id !== id);
                setReminders(updatedReminders);
                await storage.set('health-reminders', updatedReminders);
            }

            async function saveProfile(profileData) {
                setUserProfile(profileData);
                await storage.set('health-profile', profileData);
                setShowProfileModal(false);
                addBotMessage(`‚úÖ Thank you! I've saved your health profile. This helps me provide more personalized advice for you. How can I help you today?`);
            }

            // Request notification permission
            useEffect(() => {
                if ("Notification" in window && Notification.permission === "default") {
                    Notification.requestPermission();
                }
            }, []);

            return (
                <div className="app-container">
                    <Header 
                        onShowProfile={() => setShowProfileModal(true)}
                        onShowReminders={() => {}}
                        isOnline={true}
                    />
                    
                    <div className="main-layout">
                        <Sidebar 
                            reminders={reminders}
                            onAddReminder={() => setShowReminderModal(true)}
                            onDeleteReminder={deleteReminder}
                            userProfile={userProfile}
                        />
                        
                        <ChatArea 
                            messages={messages}
                            inputValue={inputValue}
                            setInputValue={setInputValue}
                            onSend={sendMessage}
                            isTyping={isTyping}
                            onQuickAsk={quickAsk}
                            conversationContext={conversationContext}
                            messagesEndRef={messagesEndRef}
                            chatInputRef={chatInputRef}
                            handleKeyPress={handleKeyPress}
                        />
                    </div>

                    {showReminderModal && (
                        <ReminderModal 
                            onClose={() => setShowReminderModal(false)}
                            onSave={addReminder}
                        />
                    )}

                    {showProfileModal && (
                        <ProfileModal 
                            onClose={() => setShowProfileModal(false)}
                            onSave={saveProfile}
                            currentProfile={userProfile}
                        />
                    )}
                </div>
            );
        }

        // Header Component
        function Header({ onShowProfile, isOnline }) {
            return (
                <div className="header">
                    <h1>üè• HealthCare AI Assistant</h1>
                    <div style={{ display: 'flex', gap: '15px', alignItems: 'center' }}>
                        <div className="status-indicator">
                            <div className="status-dot"></div>
                            <span>AI Online</span>
                        </div>
                        <button className="header-btn" onClick={onShowProfile}>
                            üìä My Profile
                        </button>
                    </div>
                </div>
            );
        }

        // Sidebar Component
        function Sidebar({ reminders, onAddReminder, onDeleteReminder, userProfile }) {
            return (
                <div className="sidebar">
                    <div className="sidebar-section">
                        <h3>üíä Medicine Reminders</h3>
                        {reminders.length === 0 ? (
                            <p style={{ color: '#999', textAlign: 'center', padding: '20px', fontSize: '0.9em' }}>
                                No reminders set yet
                            </p>
                        ) : (
                            reminders.map(reminder => (
                                <div key={reminder.id} className="reminder-card">
                                    <div className="reminder-header">
                                        <span className="reminder-name">{reminder.name}</span>
                                        <span className="reminder-time">{reminder.time}</span>
                                    </div>
                                    <div className="reminder-details">
                                        <div>üíä {reminder.dosage}</div>
                                        <div>üîÑ {reminder.frequency}</div>
                                        {reminder.notes && <div>üìù {reminder.notes}</div>}
                                    </div>
                                    <button 
                                        className="delete-btn" 
                                        onClick={() => onDeleteReminder(reminder.id)}
                                    >
                                        Delete
                                    </button>
                                </div>
                            ))
                        )}
                        <button className="add-reminder-btn" onClick={onAddReminder}>
                            + Add Reminder
                        </button>
                    </div>

                    {userProfile.age && (
                        <div className="sidebar-section">
                            <h3>üë§ Your Profile</h3>
                            <div className="health-stats">
                                <div className="stat-item">
                                    <span className="stat-label">Age</span>
                                    <span className="stat-value">{userProfile.age} years</span>
                                </div>
                                {userProfile.gender && (
                                    <div className="stat-item">
                                        <span className="stat-label">Gender</span>
                                        <span className="stat-value">{userProfile.gender}</span>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    <div className="sidebar-section">
                        <h3>üí° Health Tip</h3>
                        <div className="health-tip-card">
                            <h4>Stay Hydrated!</h4>
                            <p>Drink at least 8 glasses of water daily. Proper hydration supports all bodily functions and helps maintain energy levels.</p>
                        </div>
                    </div>
                </div>
            );
        }

        // Chat Area Component
        function ChatArea({ messages, inputValue, setInputValue, onSend, isTyping, onQuickAsk, conversationContext, messagesEndRef, chatInputRef, handleKeyPress }) {
            return (
                <div className="chat-container">
                    {conversationContext.symptoms.length > 0 && (
                        <div className="context-banner">
                            <span>üîç</span>
                            <div>
                                <strong>Active symptoms:</strong> {conversationContext.symptoms.map(s => (
                                    <span key={s} className="symptom-badge">{s}</span>
                                ))}
                            </div>
                        </div>
                    )}

                    <div className="chat-messages">
                        {messages.map((msg, idx) => (
                            <Message key={idx} message={msg} />
                        ))}
                        {isTyping && <TypingIndicator />}
                        <div ref={messagesEndRef} />
                    </div>

                    <div className="quick-actions">
                        <button className="quick-btn" onClick={() => { setInputValue("I'm feeling feverish, what should I do?"); setTimeout(() => sendMessage(), 100); }}>
                            ü§í Fever Help
                        </button>
                        <button className="quick-btn" onClick={() => { setInputValue("Create a diabetes-friendly diet plan for me"); setTimeout(() => sendMessage(), 100); }}>
                            üçé Diabetes Diet
                        </button>
                        <button className="quick-btn" onClick={() => { setInputValue("What exercises are safe for elderly people?"); setTimeout(() => sendMessage(), 100); }}>
                            üßì Senior Exercise
                        </button>
                        <button className="quick-btn" onClick={() => { setInputValue("How can I improve my sleep quality?"); setTimeout(() => sendMessage(), 100); }}>
                            üò¥ Better Sleep
                        </button>
                        <button className="quick-btn" onClick={() => { setInputValue("Give me tips for managing stress"); setTimeout(() => sendMessage(), 100); }}>
                            üßò Stress Management
                        </button>
                    </div>

                    <div className="chat-input-area">
                        <div className="input-wrapper">
                            <textarea
                                ref={chatInputRef}
                                className="chat-input"
                                value={inputValue}
                                onChange={(e) => setInputValue(e.target.value)}
                                onKeyPress={handleKeyPress}
                                placeholder="Describe your symptoms or ask me anything about your health..."
                                rows="1"
                            />
                            <button 
                                className="send-btn" 
                                onClick={onSend}
                                disabled={!inputValue.trim() || isTyping}
                            >
                                {isTyping ? 'Thinking...' : 'Send'}
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // Message Component
        function Message({ message }) {
            const formatText = (text) => {
                return text
                    .split('\n')
                    .map((line, i) => (
                        <React.Fragment key={i}>
                            {line.split('**').map((part, j) => 
                                j % 2 === 0 ? part : <strong key={j}>{part}</strong>
                            )}
                            <br />
                        </React.Fragment>
                    ));
            };

            return (
                <div className={`message ${message.type}`}>
                    <div className="message-avatar">
                        {message.type === 'bot' ? 'üè•' : 'üë§'}
                    </div>
                    <div className="message-content">
                        {formatText(message.text)}
                    </div>
                </div>
            );
        }

        // Typing Indicator Component
        function TypingIndicator() {
            return (
                <div className="message bot">
                    <div className="message-avatar">üè•</div>
                    <div className="typing-indicator">
                        <div className="typing-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                </div>
            );
        }

        // Reminder Modal Component
        function ReminderModal({ onClose, onSave }) {
            const [formData, setFormData] = useState({
                name: '',
                dosage: '',
                time: '',
                frequency: 'daily',
                notes: ''
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!formData.name || !formData.dosage || !formData.time) {
                    alert('Please fill in all required fields');
                    return;
                }
                onSave(formData);
            };

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={(e) => e.stopPropagation()}>
                        <h2>üíä Add Medicine Reminder</h2>
                        <form onSubmit={handleSubmit}>
                            <div className="form-group">
                                <label>Medicine Name *</label>
                                <input 
                                    type="text" 
                                    value={formData.name}
                                    onChange={(e) => setFormData({...formData, name: e.target.value})}
                                    placeholder="e.g., Aspirin, Metformin"
                                />
                            </div>
                            <div className="form-group">
                                <label>Dosage *</label>
                                <input 
                                    type="text" 
                                    value={formData.dosage}
                                    onChange={(e) => setFormData({...formData, dosage: e.target.value})}
                                    placeholder="e.g., 1 tablet, 5ml"
                                />
                            </div>
                            <div className="form-group">
                                <label>Time *</label>
                                <input 
                                    type="time" 
                                    value={formData.time}
                                    onChange={(e) => setFormData({...formData, time: e.target.value})}
                                />
                            </div>
                            <div className="form-group">
                                <label>Frequency</label>
                                <select 
                                    value={formData.frequency}
                                    onChange={(e) => setFormData({...formData, frequency: e.target.value})}
                                >
                                    <option value="daily">Daily</option>
                                    <option value="twice">Twice a day</option>
                                    <option value="thrice">Three times a day</option>
                                    <option value="weekly">Weekly</option>
                                </select>
                            </div>
                            <div className="form-group">
                                <label>Notes (optional)</label>
                                <textarea 
                                    rows="3"
                                    value={formData.notes}
                                    onChange={(e) => setFormData({...formData, notes: e.target.value})}
                                    placeholder="e.g., Take with food, Before bedtime"
                                />
                            </div>
                            <button type="submit" className="btn-primary">Add Reminder</button>
                            <button type="button" className="btn-secondary" onClick={onClose}>Cancel</button>
                        </form>
                    </div>
                </div>
            );
        }

        // Profile Modal Component
        function ProfileModal({ onClose, onSave, currentProfile }) {
            const [formData, setFormData] = useState(currentProfile || {
                name: '',
                email: '',
                phone: '',
                age: '',
                gender: '',
                conditions: '',
                allergies: ''
            });
            const [isSaving, setIsSaving] = useState(false);

            const handleSubmit = async (e) => {
                e.preventDefault();
                
                // Validate required fields
                if (!formData.name || !formData.email || !formData.phone) {
                    alert('Please fill in Name, Email, and Phone Number - these are required fields.');
                    return;
                }

                // Validate email format
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(formData.email)) {
                    alert('Please enter a valid email address.');
                    return;
                }

                // Validate phone format (basic validation)
                const phoneRegex = /^[0-9]{10,15}$/;
                if (!phoneRegex.test(formData.phone.replace(/[\s-()]/g, ''))) {
                    alert('Please enter a valid phone number (10-15 digits).');
                    return;
                }

                setIsSaving(true);
                
                // Send lead information to email
                await sendLeadToEmail(formData);
                
                // Save to local storage
                onSave(formData);
                setIsSaving(false);
            };

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={(e) => e.stopPropagation()}>
                        <h2>üìä Complete Your Health Profile</h2>
                        <div className="alert alert-info">
                            Your information helps us provide personalized health advice and allows our healthcare team to contact you if needed.
                        </div>
                        <form onSubmit={handleSubmit}>
                            <div className="form-group">
                                <label>Full Name *</label>
                                <input 
                                    type="text" 
                                    value={formData.name}
                                    onChange={(e) => setFormData({...formData, name: e.target.value})}
                                    placeholder="Enter your full name"
                                    required
                                />
                            </div>
                            <div className="form-group">
                                <label>Email Address *</label>
                                <input 
                                    type="email" 
                                    value={formData.email}
                                    onChange={(e) => setFormData({...formData, email: e.target.value})}
                                    placeholder="your.email@example.com"
                                    required
                                />
                            </div>
                            <div className="form-group">
                                <label>Phone Number *</label>
                                <input 
                                    type="tel" 
                                    value={formData.phone}
                                    onChange={(e) => setFormData({...formData, phone: e.target.value})}
                                    placeholder="10-digit phone number"
                                    required
                                />
                            </div>
                            <div className="form-group">
                                <label>Age</label>
                                <input 
                                    type="number" 
                                    value={formData.age}
                                    onChange={(e) => setFormData({...formData, age: e.target.value})}
                                    placeholder="Enter your age"
                                />
                            </div>
                            <div className="form-group">
                                <label>Gender</label>
                                <select 
                                    value={formData.gender}
                                    onChange={(e) => setFormData({...formData, gender: e.target.value})}
                                >
                                    <option value="">Select</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div className="form-group">
                                <label>Existing Health Conditions</label>
                                <textarea 
                                    rows="3"
                                    value={formData.conditions}
                                    onChange={(e) => setFormData({...formData, conditions: e.target.value})}
                                    placeholder="e.g., Diabetes, High blood pressure, Arthritis"
                                />
                            </div>
                            <div className="form-group">
                                <label>Allergies</label>
                                <textarea 
                                    rows="2"
                                    value={formData.allergies}
                                    onChange={(e) => setFormData({...formData, allergies: e.target.value})}
                                    placeholder="e.g., Penicillin, Peanuts, Shellfish"
                                />
                            </div>
                            <div className="alert alert-warning">
                                <small>* Required fields. By submitting, you consent to be contacted by our healthcare team for personalized assistance.</small>
                            </div>
                            <button type="submit" className="btn-primary" disabled={isSaving}>
                                {isSaving ? 'Saving...' : 'Save Profile'}
                            </button>
                            <button type="button" className="btn-secondary" onClick={onClose}>Cancel</button>
                        </form>
                    </div>
                </div>
            );
        }

        // Function to send lead information via email
        async function sendLeadToEmail(profileData) {
            try {
                const emailBody = `
New Health Chatbot Lead Submission
===================================

CONTACT INFORMATION:
-------------------
Name: ${profileData.name}
Email: ${profileData.email}
Phone: ${profileData.phone}

HEALTH PROFILE:
--------------
Age: ${profileData.age || 'Not provided'}
Gender: ${profileData.gender || 'Not provided'}

Existing Health Conditions:
${profileData.conditions || 'None specified'}

Allergies:
${profileData.allergies || 'None specified'}

SUBMISSION DETAILS:
------------------
Date: ${new Date().toLocaleString()}
Source: HealthCare AI Assistant Chatbot

---
This lead was automatically captured from the HealthCare AI Assistant platform.
Please follow up with the patient at the provided contact information.
                `.trim();

                // Using Web3Forms API (free email service)
                const response = await fetch('https://api.web3forms.com/submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        access_key: '5e99e6e5-1b48-49a8-a151-7cd1650a7d04',
                        subject: `New Health Lead: ${profileData.name}`,
                        from_name: 'HealthCare AI Assistant',
                        to_email: 'gaurmayank1978@gmail.com',
                        message: emailBody,
                        // Additional fields for better tracking
                        name: profileData.name,
                        email: profileData.email,
                        phone: profileData.phone,
                        age: profileData.age,
                        gender: profileData.gender,
                        conditions: profileData.conditions,
                        allergies: profileData.allergies
                    })
                });

                const result = await response.json();
                
                if (!result.success) {
                    console.error('Failed to send email:', result);
                    // Still save locally even if email fails
                }
            } catch (error) {
                console.error('Error sending lead email:', error);
                // Don't block the profile save if email fails
            }
        }

        // Render the app
        ReactDOM.render(<HealthCareApp />, document.getElementById('root'));
    </script>
</body>
</html>
